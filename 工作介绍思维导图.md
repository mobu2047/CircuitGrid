# MAPSé¡¹ç›®å·¥ä½œä»‹ç»æ€ç»´å¯¼å›¾

## æ ¸å¿ƒå·¥ä½œæ¶æ„ï¼ˆç»Ÿä¸€è§†å›¾ï¼‰

```mermaid
flowchart TB
    subgraph Work1[å·¥ä½œä¸€ï¼šæ•°æ®ç”Ÿæˆè„šæœ¬]
        Config[é…ç½®å‚æ•°<br/>ç‰ˆæœ¬å·/æ•°é‡/ç¼–è¾‘æ•°]
        GenBase[ç”ŸæˆåŸºç¡€ç”µè·¯<br/>gen_circuit]
        GenEdit[ç”Ÿæˆç¼–è¾‘æ“ä½œ<br/>EditGenerator]
        ApplyEdit[åº”ç”¨ç¼–è¾‘<br/>ParameterEditOperation]
        GenDesc[ç”Ÿæˆæè¿°<br/>stat_to_natural_language]
    end
    
    subgraph Work2[å·¥ä½œäºŒï¼šåŸç†å›¾æ­å»ºå·¥å…·]
        GUI[å›¾å½¢ç•Œé¢<br/>Tkinter]
        Edit[å¯è§†åŒ–ç¼–è¾‘<br/>GridCanvas]
        Property[å±æ€§ç¼–è¾‘<br/>PropertyPanel]
    end
    
    subgraph GridCore[Gridæ•°æ®æ ¼å¼æ ¸å¿ƒ]
        Circuit[Circuitç±»<br/>grid_rules.py]
        GridModel[GridModelç±»<br/>grid_model.py]
        GridJSON[Grid JSONæ ¼å¼<br/>ç»Ÿä¸€æ•°æ®è¡¨ç¤º]
    end
    
    subgraph Output[è¾“å‡ºæ ¼å¼]
        LaTeX[LaTeXåŸç†å›¾<br/>circuit.tex]
        SPICE[SPICEä»£ç <br/>circuit.sp]
        PNG[æ¸²æŸ“å›¾åƒ<br/>circuit.png]
        Desc[ç”µè·¯æè¿°<br/>description.txt]
        EditDesc[ç¼–è¾‘æè¿°<br/>edit_instruction.txt]
    end
    
    Config --> GenBase
    GenBase --> Circuit
    GenEdit --> ApplyEdit
    ApplyEdit --> Circuit
    GenBase --> GenDesc
    
    GUI --> Edit
    Edit --> GridModel
    Property --> GridModel
    GridModel --> Circuit
    
    Circuit --> GridJSON
    GridJSON --> LaTeX
    GridJSON --> SPICE
    GridJSON --> GenDesc
    GenDesc --> Desc
    GenDesc --> EditDesc
    
    LaTeX --> PNG
    
    style Work1 fill:#e1f5ff
    style Work2 fill:#fff4e1
    style GridCore fill:#e8f5e9
    style Output fill:#f3e5f5
    style Circuit fill:#ffeb3b,stroke:#f57f17,stroke-width:3px
    style GridJSON fill:#ffeb3b,stroke:#f57f17,stroke-width:3px
```

---

## è¯¦ç»†å·¥ä½œæµç¨‹

### å®Œæ•´æ•°æ®æµå›¾

```mermaid
flowchart LR
    subgraph AutoGen[è‡ªåŠ¨ç”Ÿæˆè·¯å¾„]
        A1[é…ç½®å‚æ•°] --> A2[gen_circuit<br/>ç”ŸæˆåŸºç¡€ç”µè·¯]
        A2 --> A3[Circuitå¯¹è±¡<br/>Gridæ ¼å¼]
        A3 --> A4[ç”Ÿæˆç¼–è¾‘æ“ä½œ]
        A4 --> A5[åº”ç”¨ç¼–è¾‘]
        A5 --> A3
    end
    
    subgraph ManualEdit[æ‰‹åŠ¨ç¼–è¾‘è·¯å¾„]
        M1[å¯åŠ¨GUIå·¥å…·] --> M2[å¯è§†åŒ–ç¼–è¾‘]
        M2 --> M3[GridModelå¯¹è±¡]
        M3 --> M4[ä¿å­˜Grid JSON]
        M4 --> M5[è½¬æ¢ä¸ºCircuitå¯¹è±¡]
    end
    
    subgraph GridFormat[Gridæ•°æ®æ ¼å¼<br/>ç»Ÿä¸€æ ¸å¿ƒ]
        G1[Grid JSONæ ¼å¼<br/>circuit.json]
        G2[Circuitç±»<br/>å†…å­˜å¯¹è±¡]
    end
    
    subgraph Convert[æ ¼å¼è½¬æ¢]
        C1[to_latex<br/>LaTeXè½¬æ¢]
        C2[_to_SPICE<br/>SPICEè½¬æ¢]
        C3[ç¼–è¯‘æ¸²æŸ“<br/>PNGç”Ÿæˆ]
        C4[æè¿°ç”Ÿæˆ<br/>è‡ªç„¶è¯­è¨€]
    end
    
    subgraph FinalOutput[æœ€ç»ˆè¾“å‡º]
        F1[circuit.tex<br/>LaTeXåŸç†å›¾]
        F2[circuit.sp<br/>SPICEä»£ç ]
        F3[circuit.png<br/>æ¸²æŸ“å›¾åƒ]
        F4[description.txt<br/>ç”µè·¯æè¿°]
        F5[edit_instruction.txt<br/>ç¼–è¾‘æè¿°]
    end
    
    A3 --> G2
    M5 --> G2
    G2 --> G1
    G1 --> G2
    
    G2 --> C1
    G2 --> C2
    G2 --> C4
    
    C1 --> C3
    C3 --> F3
    C1 --> F1
    C2 --> F2
    C4 --> F4
    C4 --> F5
    
    style GridFormat fill:#ffeb3b,stroke:#f57f17,stroke-width:4px
    style G1 fill:#ffeb3b,stroke:#f57f17,stroke-width:3px
    style G2 fill:#ffeb3b,stroke:#f57f17,stroke-width:3px
    style AutoGen fill:#e1f5ff
    style ManualEdit fill:#fff4e1
    style FinalOutput fill:#e8f5e9
```

---

## å·¥ä½œä¸€ï¼šæ•°æ®ç”Ÿæˆè„šæœ¬

### åŠŸèƒ½æµç¨‹

```mermaid
flowchart TD
    Start[å¼€å§‹] --> Config[é…ç½®å‚æ•°<br/>--note v11<br/>--gen_num 100<br/>--num_edits 3]
    
    Config --> GenBase[ç”ŸæˆåŸºç¡€ç”µè·¯<br/>gen_circuit]
    GenBase --> Circuit1[Circuitå¯¹è±¡<br/>Gridæ ¼å¼]
    
    Circuit1 --> GenDesc1[ç”ŸæˆåŸºç¡€æè¿°<br/>stat_to_natural_language]
    Circuit1 --> Export1[å¯¼å‡ºæ ¼å¼]
    
    Export1 --> LaTeX1[circuit.tex]
    Export1 --> SPICE1[circuit.sp]
    Export1 --> PNG1[circuit.png]
    Export1 --> Desc1[description.txt]
    
    Circuit1 --> GenEdit[ç”Ÿæˆç¼–è¾‘æ“ä½œ<br/>EditGenerator]
    GenEdit --> ApplyEdit[åº”ç”¨ç¼–è¾‘<br/>ParameterEditOperation]
    ApplyEdit --> Circuit2[ä¿®æ”¹åçš„Circuitå¯¹è±¡]
    
    Circuit2 --> GenDesc2[ç”Ÿæˆç¼–è¾‘æè¿°]
    Circuit2 --> Export2[å¯¼å‡ºæ ¼å¼]
    
    Export2 --> LaTeX2[circuit.tex]
    Export2 --> SPICE2[circuit.sp]
    Export2 --> PNG2[circuit.png]
    Export2 --> EditDesc[edit_instruction.txt]
    
    GenDesc1 --> SaveBase[ä¿å­˜base/ç›®å½•]
    GenDesc2 --> SaveEdit[ä¿å­˜edit_1/ç›®å½•]
    SaveBase --> SaveMeta[ä¿å­˜metadata.json]
    SaveEdit --> SaveMeta
    SaveMeta --> End[å®Œæˆ]
    
    style Circuit1 fill:#ffeb3b,stroke:#f57f17,stroke-width:2px
    style Circuit2 fill:#ffeb3b,stroke:#f57f17,stroke-width:2px
    style GenBase fill:#e1f5ff
    style Export1 fill:#e8f5e9
    style Export2 fill:#e8f5e9
```

**æ ¸å¿ƒç‰¹ç‚¹**:
- âœ… æ‰¹é‡è‡ªåŠ¨ç”Ÿæˆçº¿æ€§ç”µè·¯
- âœ… è‡ªåŠ¨ç”Ÿæˆç”µè·¯æè¿°ï¼ˆè‡ªç„¶è¯­è¨€ï¼‰
- âœ… è‡ªåŠ¨ç”Ÿæˆä¿®æ”¹ç”µè·¯åŠä¿®æ”¹æè¿°
- âœ… è¾“å‡ºå¤šæ ¼å¼æ•°æ®ï¼šLaTeXã€SPICEã€PNGã€æè¿°æ–‡æœ¬

---

## å·¥ä½œäºŒï¼šåŸç†å›¾æ­å»ºå·¥å…·

### åŠŸèƒ½æµç¨‹

```mermaid
flowchart TD
    Start[å¯åŠ¨å·¥å…·] --> GUI[æ‰“å¼€å›¾å½¢ç•Œé¢]
    GUI --> Edit[å¯è§†åŒ–ç¼–è¾‘ç”µè·¯]
    
    Edit --> AddComp[æ·»åŠ å…ƒä»¶<br/>ç»„ä»¶é¢æ¿é€‰æ‹©]
    Edit --> SetProp[è®¾ç½®å±æ€§<br/>å±æ€§é¢æ¿ç¼–è¾‘]
    Edit --> Connect[è¿æ¥èŠ‚ç‚¹<br/>ç½‘æ ¼ç”»å¸ƒæ“ä½œ]
    
    AddComp --> GridModel[GridModelå¯¹è±¡<br/>å†…å­˜æ•°æ®]
    SetProp --> GridModel
    Connect --> GridModel
    
    GridModel --> SaveGrid[ä¿å­˜Gridæ ¼å¼<br/>circuit.json]
    GridModel --> ToCircuit[è½¬æ¢ä¸ºCircuitå¯¹è±¡]
    
    ToCircuit --> AutoConvert[è‡ªåŠ¨è½¬æ¢]
    
    AutoConvert --> ToLaTeX[to_latex<br/>LaTeXè½¬æ¢]
    AutoConvert --> ToSPICE[_to_SPICE<br/>SPICEè½¬æ¢]
    
    ToLaTeX --> Compile[ç¼–è¯‘LaTeX<br/>pdflatex]
    Compile --> PDF[circuit.pdf]
    PDF --> Convert[è½¬æ¢PNG<br/>ImageMagick]
    Convert --> PNG[circuit.png]
    
    ToSPICE --> SPICEFile[circuit.sp]
    ToLaTeX --> LaTeXFile[circuit.tex]
    
    SaveGrid --> End[å®Œæˆ]
    SPICEFile --> End
    LaTeXFile --> End
    PNG --> End
    
    style GridModel fill:#ffeb3b,stroke:#f57f17,stroke-width:2px
    style ToCircuit fill:#ffeb3b,stroke:#f57f17,stroke-width:2px
    style SaveGrid fill:#ffeb3b,stroke:#f57f17,stroke-width:2px
    style Edit fill:#e1f5ff
    style AutoConvert fill:#fff4e1
    style End fill:#e8f5e9
```

**æ ¸å¿ƒç‰¹ç‚¹**:
- âœ… å¯è§†åŒ–æ‰‹åŠ¨ç¼–è¾‘ç”µè·¯åŸç†å›¾
- âœ… ä¿å­˜ä¸ºGridæ ¼å¼ï¼ˆJSONï¼‰
- âœ… è‡ªåŠ¨è½¬æ¢ä¸ºSPICEå’ŒLaTeX
- âœ… è‡ªåŠ¨æ¸²æŸ“ç”ŸæˆPNGå›¾åƒ

---

## Gridæ•°æ®æ ¼å¼ï¼šç»Ÿä¸€æ ¸å¿ƒ

### Gridæ ¼å¼ç»“æ„

```mermaid
graph TB
    subgraph GridFormat[Gridæ•°æ®æ ¼å¼]
        JSON[Grid JSONæ–‡ä»¶<br/>circuit.json]
        Circuit[Circuitç±»å¯¹è±¡<br/>å†…å­˜è¡¨ç¤º]
        GridModel[GridModelç±»å¯¹è±¡<br/>ç¼–è¾‘å™¨ä½¿ç”¨]
    end
    
    subgraph GridData[Gridæ•°æ®ç»“æ„]
        Size[ç½‘æ ¼å°ºå¯¸<br/>m Ã— n]
        Nodes[èŠ‚ç‚¹æ•°ç»„<br/>grid_nodes]
        Edges[è¾¹æ•°ç»„<br/>has_hedge/has_vedge]
        Components[å…ƒä»¶ä¿¡æ¯<br/>ç±»å‹/å€¼/å•ä½/æ ‡ç­¾]
        NodeComps[èŠ‚ç‚¹å…ƒä»¶<br/>ä¸‰æç®¡/äºŒæç®¡/è¿æ”¾]
    end
    
    subgraph Conversion[æ ¼å¼è½¬æ¢]
        ToCircuit[GridModel â†’ Circuit]
        FromCircuit[Circuit â†’ GridModel]
        ToJSON[Circuit â†’ JSON]
        FromJSON[JSON â†’ Circuit]
    end
    
    JSON --> Circuit
    GridModel --> Circuit
    Circuit --> GridData
    
    GridModel <--> ToCircuit <--> Circuit
    Circuit <--> ToJSON <--> JSON
    
    style GridFormat fill:#ffeb3b,stroke:#f57f17,stroke-width:3px
    style Circuit fill:#ffeb3b,stroke:#f57f17,stroke-width:2px
    style JSON fill:#ffeb3b,stroke:#f57f17,stroke-width:2px
```

### Gridæ ¼å¼è¿æ¥ä¸¤ä¸ªå·¥ä½œ

```mermaid
flowchart TB
    subgraph Work1[å·¥ä½œä¸€ï¼šæ•°æ®ç”Ÿæˆ]
        Gen[gen_circuitå‡½æ•°] --> Circuit1[Circuitå¯¹è±¡<br/>Gridæ ¼å¼]
        Circuit1 --> Export1[å¯¼å‡ºLaTeX/SPICE/PNG]
    end
    
    subgraph Work2[å·¥ä½œäºŒï¼šæ­å»ºå·¥å…·]
        Edit[GUIç¼–è¾‘] --> GridModel[GridModelå¯¹è±¡]
        GridModel --> Save[ä¿å­˜JSON]
        GridModel --> Circuit2[è½¬æ¢ä¸ºCircuitå¯¹è±¡]
        Circuit2 --> Export2[å¯¼å‡ºLaTeX/SPICE/PNG]
    end
    
    subgraph Common[å…±åŒæ ¸å¿ƒ]
        GridJSON[Grid JSONæ ¼å¼<br/>circuit.json]
        CircuitClass[Circuitç±»<br/>grid_rules.py]
        Convert[æ ¼å¼è½¬æ¢<br/>to_latex/_to_SPICE]
    end
    
    Circuit1 --> CircuitClass
    Circuit2 --> CircuitClass
    CircuitClass --> GridJSON
    CircuitClass --> Convert
    
    Export1 --> Output[å¤šæ ¼å¼è¾“å‡º]
    Export2 --> Output
    
    style Common fill:#ffeb3b,stroke:#f57f17,stroke-width:4px
    style CircuitClass fill:#ffeb3b,stroke:#f57f17,stroke-width:3px
    style GridJSON fill:#ffeb3b,stroke:#f57f17,stroke-width:3px
    style Work1 fill:#e1f5ff
    style Work2 fill:#fff4e1
    style Output fill:#e8f5e9
```

---

## æ•°æ®æµå‘å›¾

### å®Œæ•´æ•°æ®æµ

```mermaid
flowchart LR
    subgraph Source1[æ•°æ®æº1ï¼šè‡ªåŠ¨ç”Ÿæˆ]
        S1[é…ç½®] --> S2[gen_circuit]
        S2 --> S3[Circuitå¯¹è±¡]
    end
    
    subgraph Source2[æ•°æ®æº2ï¼šæ‰‹åŠ¨ç¼–è¾‘]
        M1[GUIç¼–è¾‘] --> M2[GridModel]
        M2 --> M3[Circuitå¯¹è±¡]
    end
    
    subgraph Grid[Gridç»Ÿä¸€æ ¼å¼]
        G1[Circuitå¯¹è±¡]
        G2[Grid JSON]
    end
    
    subgraph Process[å¤„ç†è½¬æ¢]
        P1[to_latex]
        P2[_to_SPICE]
        P3[æè¿°ç”Ÿæˆ]
        P4[ç¼–è¯‘æ¸²æŸ“]
    end
    
    subgraph Output[è¾“å‡ºæ–‡ä»¶]
        O1[circuit.tex]
        O2[circuit.sp]
        O3[circuit.png]
        O4[description.txt]
        O5[edit_instruction.txt]
    end
    
    S3 --> G1
    M3 --> G1
    G1 --> G2
    G2 --> G1
    
    G1 --> P1
    G1 --> P2
    G1 --> P3
    
    P1 --> P4
    P1 --> O1
    P2 --> O2
    P3 --> O4
    P3 --> O5
    P4 --> O3
    
    style Grid fill:#ffeb3b,stroke:#f57f17,stroke-width:4px
    style G1 fill:#ffeb3b,stroke:#f57f17,stroke-width:3px
    style G2 fill:#ffeb3b,stroke:#f57f17,stroke-width:3px
```

---

## è¾“å‡ºæ•°æ®å¯¹æ¯”

### å·¥ä½œä¸€è¾“å‡ºç»“æ„

```
edit_dataset/
  â””â”€â”€ circuit_1/
      â”œâ”€â”€ base/
      â”‚   â”œâ”€â”€ circuit.tex      # LaTeXåŸç†å›¾
      â”‚   â”œâ”€â”€ circuit.sp       # SPICEä»£ç 
      â”‚   â”œâ”€â”€ circuit.png      # æ¸²æŸ“å›¾åƒ
      â”‚   â”œâ”€â”€ description.txt  # ç”µè·¯æè¿°
      â”‚   â””â”€â”€ stat.json        # ç»Ÿè®¡ä¿¡æ¯
      â”œâ”€â”€ edit_1/
      â”‚   â”œâ”€â”€ circuit.tex
      â”‚   â”œâ”€â”€ circuit.sp
      â”‚   â”œâ”€â”€ circuit.png
      â”‚   â”œâ”€â”€ edit_instruction.txt  # ç¼–è¾‘æè¿°
      â”‚   â””â”€â”€ stat.json
      â””â”€â”€ metadata.json        # å…ƒæ•°æ®
```

### å·¥ä½œäºŒè¾“å‡ºç»“æ„

```
circuit.json              # Gridæ ¼å¼ï¼ˆæ ¸å¿ƒï¼‰
circuit.sp               # SPICEä»£ç 
circuit.tex              # LaTeXä»£ç 
circuit.pdf              # PDFæ–‡ä»¶
circuit.png              # æ¸²æŸ“å›¾åƒ
```

**å…±åŒç‚¹**: éƒ½é€šè¿‡Gridæ ¼å¼ï¼ˆCircuitç±»ï¼‰ç”ŸæˆLaTeXã€SPICEå’ŒPNG

---

## æŠ€æœ¯å®ç°æ ¸å¿ƒ

### Gridæ ¼å¼è½¬æ¢èƒ½åŠ›

```mermaid
mindmap
  root((Gridæ•°æ®æ ¼å¼))
    æ•°æ®è¡¨ç¤º
      JSONæ ¼å¼å­˜å‚¨
      Circuitç±»å¯¹è±¡
      GridModelç±»å¯¹è±¡
    è½¬æ¢èƒ½åŠ›
      Grid â†’ LaTeX
      Grid â†’ SPICE
      Grid â†’ PNG
      Grid â†” JSON
    ç»Ÿä¸€æ¥å£
      ä¸¤ä¸ªå·¥ä½œå…±ç”¨
      Circuitç±»æ ¸å¿ƒ
      grid_rules.pyå¼•æ“
    æ•°æ®å®Œæ•´æ€§
      å…ƒä»¶ä¿¡æ¯
      æ‹“æ‰‘ç»“æ„
      å‚æ•°å€¼
      è¿æ¥å…³ç³»
```

---

## æ€»ç»“

### å·¥ä½œä¸€ï¼šæ•°æ®ç”Ÿæˆè„šæœ¬
- âœ… **æ‰¹é‡ç”Ÿæˆ**çº¿æ€§ç”µè·¯åŠå…¶æè¿°
- âœ… **è‡ªåŠ¨ç”Ÿæˆ**ä¿®æ”¹ç”µè·¯åŠä¿®æ”¹æè¿°  
- âœ… **å¤šæ ¼å¼è¾“å‡º**ï¼šåŸç†å›¾(LaTeX)ã€SPICEã€PNGã€æè¿°æ–‡æœ¬
- âœ… **æ ¸å¿ƒ**ï¼šé€šè¿‡Circuitç±»ï¼ˆGridæ ¼å¼ï¼‰è¿›è¡Œè½¬æ¢

### å·¥ä½œäºŒï¼šåŸç†å›¾æ­å»ºå·¥å…·
- âœ… **å¯è§†åŒ–ç¼–è¾‘**ç”µè·¯åŸç†å›¾
- âœ… **Gridæ ¼å¼**ä¿å­˜ç”µè·¯æ•°æ®ï¼ˆJSONï¼‰
- âœ… **è‡ªåŠ¨è½¬æ¢**ä¸ºSPICEå’ŒLaTeX
- âœ… **è‡ªåŠ¨æ¸²æŸ“**ç”Ÿæˆå›¾åƒ
- âœ… **æ ¸å¿ƒ**ï¼šGridModel â†’ Circuitç±»ï¼ˆGridæ ¼å¼ï¼‰â†’ è½¬æ¢è¾“å‡º

### ç»Ÿä¸€æ ¸å¿ƒï¼šGridæ•°æ®æ ¼å¼
- ğŸ”— **è¿æ¥ç‚¹**ï¼šä¸¤ä¸ªå·¥ä½œéƒ½ä½¿ç”¨Gridæ ¼å¼ï¼ˆCircuitç±»ï¼‰ä½œä¸ºæ ¸å¿ƒ
- ğŸ”— **è½¬æ¢å¼•æ“**ï¼šgrid_rules.pyæä¾›Grid â†” LaTeX â†” SPICEåŒå‘è½¬æ¢
- ğŸ”— **æ•°æ®æ ¼å¼**ï¼šJSONæ ¼å¼ä¾¿äºå­˜å‚¨å’Œäº¤æ¢

---

*æœ€åæ›´æ–°: 2025å¹´*
